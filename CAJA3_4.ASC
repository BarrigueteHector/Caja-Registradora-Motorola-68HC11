***********************************
*    DECLARACION  DE CONSTANTES   *
***********************************
SCDR   EQU   $102F
SCCR2  EQU   $102D
SCSR   EQU   $102E
SCCR1  EQU   $102C
BAUD   EQU   $102B
HPRIO  EQU   $103C
DDRD   EQU   $1009

***********************************
*   DECLARACION  DE  VARIABLES    *
***********************************
PRO	EQU $0000
DMILL	EQU $0001
UMILL	EQU $0002
CM	EQU $0003
DM	EQU $0004
UM	EQU $0005
C	EQU $0006
D	EQU $0007
U	EQU $0008

CONTA	EQU $0009
CONTB	EQU $000A
CONTC	EQU $000B
CONTD	EQU $000C
CONTE	EQU $000D
CONTF	EQU $000E
CONTG	EQU $000F
CONTH	EQU $0010
CONTI	EQU $0011
CONTJ	EQU $0012

O	EQU $0013

CUA	EQU $0016
CDA	EQU $0015
CCA	EQU $0014
CUB	EQU $0019
CDB	EQU $0018
CCB	EQU $0017
CUC	EQU $001C
CDC	EQU $001B
CCC	EQU $001A
CUD	EQU $001F
CDD	EQU $001E
CCD	EQU $001D
CUE	EQU $0022
CDE	EQU $0021
CCE	EQU $0020
CUF	EQU $0025
CDF	EQU $0024
CCF	EQU $0023
CUG	EQU $0028
CDG	EQU $0027
CCG	EQU $0026
CUH	EQU $002B
CDH	EQU $002A
CCH	EQU $0029
CUI	EQU $002E
CDI	EQU $002D
CCI	EQU $002C
CUJ	EQU $0031
CDJ	EQU $0030
CCJ	EQU $002F

CONTI_PROMO3	EQU $0032
CONTJ_PROMO3	EQU $0033
ICONTA	EQU $0034
ICONTB	EQU $0035
ICONTC	EQU $0036
ICONTD	EQU $0037
ICONTE	EQU $0038
ICONTF	EQU $0039
ICONTG	EQU $003A
ICONTH	EQU $003B
ICONTI	EQU $003C
ICONTJ	EQU $003D

DIR_CANTALTO	EQU $003E
DIR_CANTBAJO	EQU $003F
DIR_IMPRALTO	EQU $0040
DIR_IMPRBAJO	EQU $0041

CONT_ANT	EQU $0042
CONT_MAYUS	EQU $0043
CONT_THOUSAND	EQU $0044
CONT_GUION	EQU $0045
CONT_AND	EQU $0046
CONT_COMA	EQU $0047

CONT_IVA EQU $0048
IVADCENT EQU $0049
IVAU EQU $004A
IVAD EQU $004B
IVAC EQU $004C
IVAUM EQU $004D
IVADM EQU $004E
IVACM EQU $004F
IVAUMILL EQU $0050
IVADMILL EQU $0051

AHR_U EQU $0052
AHR_D EQU $0053
AHR_C EQU $0054
AHR_UM EQU $0055
AHR_DM EQU $0056
AHR_CM EQU $0057
AHR_UMILL EQU $0058

AHR_AUX EQU $0059

AHR_AA EQU $005A
AHR_AB EQU $005B
AHR_AC EQU $005C
AHR_AD EQU $005D
AHR_AE EQU $005E
AHR_AF EQU $005F
AHR_AG EQU $0060
AHR_AH EQU $0061
AHR_AI EQU $0062
AHR_AJ EQU $0063


***********************************
*   CUERPO  PROGRAMA PRINCIPAL    *
***********************************
        ORG $7000
        LDS #$0300
        
        JSR SERIAL
 
INICIO
	CLR CONTA	
	CLR CONTB	
	CLR CONTC	
	CLR CONTD	
	CLR CONTE	
	CLR CONTF	
	CLR CONTG	
	CLR CONTH
	CLR CONTI
	CLR CONTJ
	CLR O
	
	JMP CICLATE_MAS

CICLATE_SIGNO
	LDAA #'?
	STAA PRO

CICLO_SIGNO
	LDAA PRO
	CMPA #'?
	BEQ CICLO_SIGNO

CHECAR_MAS
	LDAA PRO
	CMPA #'+
	BNE CHECAR_MENOS
	JMP CICLATE_MAS

CHECAR_MENOS
	LDAA PRO
	CMPA #'-
	BNE CHECAR_IGUAL
	JMP CICLATE_MENOS

CHECAR_IGUAL
	LDAA PRO
	CMPA #'=
	BNE CHECAR_N_SIGNO
	JMP CUENTA_CANTIDAD

CHECAR_N_SIGNO
	LDAA PRO
	CMPA #'N
	BNE ERROR_SIGNO
	JMP INICIO

ERROR_SIGNO
	LDX #$0080
	LDY #$91A0
	JSR IMPRESION	
	JMP OK
	
CICLATE_MAS
	LDAA #'?
	STAA PRO

CICLO_MAS
	LDAA PRO
	CMPA #'?
	BEQ CICLO_MAS

CHECAR_A
	LDAA PRO
	CMPA #'A
	BNE CHECAR_B
	INC CONTA
	JMP CICLATE_SIGNO 

CHECAR_B
	LDAA PRO
	CMPA #'B
	BNE CHECAR_C
	INC CONTB
	JMP CICLATE_SIGNO

CHECAR_C
	LDAA PRO
	CMPA #'C
	BNE CHECAR_D
	INC CONTC
	JMP CICLATE_SIGNO

CHECAR_D
	LDAA PRO
	CMPA #'D
	BNE CHECAR_E
	INC CONTD
	JMP CICLATE_SIGNO

CHECAR_E
	LDAA PRO
	CMPA #'E
	BNE CHECAR_F
	INC CONTE
	JMP CICLATE_SIGNO

CHECAR_F
	LDAA PRO
	CMPA #'F
	BNE CHECAR_G
	INC CONTF
	JMP CICLATE_SIGNO

CHECAR_G
	LDAA PRO
	CMPA #'G
	BNE CHECAR_H
	INC CONTG
	JMP CICLATE_SIGNO

CHECAR_H
	LDAA PRO
	CMPA #'H
	BNE CHECAR_I
	INC CONTH
	JMP CICLATE_SIGNO

CHECAR_I
	LDAA PRO
	CMPA #'I
	BNE CHECAR_J
	INC CONTI
	JMP CICLATE_SIGNO

CHECAR_J
	LDAA PRO
	CMPA #'J
	BNE CHECAR_N
	INC CONTJ
	JMP CICLATE_SIGNO

CHECAR_N
	LDAA PRO
	CMPA #'N
	BNE ERROR_PRO_MAS
	JMP INICIO

ERROR_PRO_MAS
	LDX #$0080
	LDY #$91A0
	JSR IMPRESION
	JMP OK

CICLATE_MENOS
	LDAA #'?
	STAA PRO

CICLO_MENOS
	LDAA PRO
	CMPA #'?
	BEQ CICLO_MENOS

CHECAR_NEG_A
	LDAA PRO
	CMPA #'A
	BNE CHECAR_NEG_B
	LDAB CONTA
	BEQ RANA
	DEC CONTA
	JMP CICLATE_SIGNO

CHECAR_NEG_B
	LDAA PRO
	CMPA #'B
	BNE CHECAR_NEG_C
	LDAB CONTB
	BEQ RANA
	DEC CONTB
	JMP CICLATE_SIGNO

CHECAR_NEG_C
	LDAA PRO
	CMPA #'C
	BNE CHECAR_NEG_D
	LDAB CONTC
	BEQ RANA
	DEC CONTC
	JMP CICLATE_SIGNO

CHECAR_NEG_D
	LDAA PRO
	CMPA #'D
	BNE CHECAR_NEG_E
	LDAB CONTD

RANA	
	BEQ ERROR_CONTADOR
	DEC CONTD
	JMP CICLATE_SIGNO

CHECAR_NEG_E
	LDAA PRO
	CMPA #'E
	BNE CHECAR_NEG_F
	LDAB CONTD
	BEQ ERROR_CONTADOR
	DEC CONTD
	JMP CICLATE_SIGNO

CHECAR_NEG_F
	LDAA PRO
	CMPA #'F
	BNE CHECAR_NEG_G
	LDAB CONTF
	BEQ ERROR_CONTADOR
	DEC CONTF
	JMP CICLATE_SIGNO

CHECAR_NEG_G
	LDAA PRO
	CMPA #'G
	BNE CHECAR_NEG_H
	LDAB CONTG
	BEQ ERROR_CONTADOR
	DEC CONTG
	JMP CICLATE_SIGNO

CHECAR_NEG_H
	LDAA PRO
	CMPA #'H
	BNE CHECAR_NEG_I
	LDAB CONTH
	BEQ ERROR_CONTADOR
	DEC CONTH
	JMP CICLATE_SIGNO

CHECAR_NEG_I
	LDAA PRO
	CMPA #'I
	BNE CHECAR_NEG_J
	LDAB CONTI
	BEQ ERROR_CONTADOR
	DEC CONTI
	JMP CICLATE_SIGNO

CHECAR_NEG_J
	LDAA PRO
	CMPA #'J
	BNE CHECAR_NEG_N
	LDAB CONTJ
	BEQ ERROR_CONTADOR
	DEC CONTJ
	JMP CICLATE_SIGNO

CHECAR_NEG_N
	LDAA PRO
	CMPA #'N
	BNE ERROR_PRO_MENOS
	JMP INICIO

ERROR_CONTADOR
	LDX #$0080
	LDY #$91B8
	JSR IMPRESION
	JMP OK

ERROR_PRO_MENOS
	LDX #$0080
	LDY #$91A0
	JSR IMPRESION
	JMP OK

********************************************************
*					CUENTA DE CANTIDAD				   *
********************************************************
CUENTA_CANTIDAD
	CLR CUA
	CLR CDA
	CLR CCA
	CLR CUB
	CLR CDB
	CLR CCB
	CLR CUC
	CLR CDC
	CLR CCC
	CLR CUD
	CLR CDD
	CLR CCD
	CLR CUE
	CLR CDE
	CLR CCE
	CLR CUF
	CLR CDF
	CLR CCF
	CLR CUG
	CLR CDG
	CLR CCG
	CLR CUH
	CLR CDH
	CLR CCH
	CLR CUI
	CLR CDI
	CLR CCI
	CLR CUJ
	CLR CDJ
	CLR CCJ
	CLR CONTI_PROMO3
	CLR CONTJ_PROMO3
	CLR ICONTA
	CLR ICONTB
	CLR ICONTC
	CLR ICONTD
	CLR ICONTE
	CLR ICONTF
	CLR ICONTG
	CLR ICONTH
	CLR ICONTI
	CLR ICONTJ
	
	LDAA CONTA
	STAA ICONTA
	LDAA CONTB
	STAA ICONTB
	LDAA CONTC
	STAA ICONTC
	LDAA CONTD
	STAA ICONTD
	LDAA CONTE
	STAA ICONTE
	LDAA CONTF
	STAA ICONTF
	LDAA CONTG
	STAA ICONTG
	LDAA CONTH
	STAA ICONTH
	LDAA CONTI
	STAA ICONTI
	LDAA CONTJ
	STAA ICONTJ

CSUM_A
	LDAA ICONTA			*inicializa A con ICONTA(cantidad de articulos A)
	BEQ CSUM_B			*si no hay pasa a CSUM_B
	CMPA #4				*A - 4
	BHI CPROMO_A2		*si el resultado es mayor a 0 pasa a CPROMO_A2
	DEC ICONTA			
	LDAB CDA
	ADDB #5
	CMPB #9
	BLS CSIN_PROMO_A
	JSR ARR_CANTC

CSIN_PROMO_A
	STAB CDA
	JMP CSUM_A

CPROMO_A2
	LDAB CUA
	ADDB #5
	CMPB #9
	BLS CCON_PROMO_A1
	JSR ARR_CANTD

CCON_PROMO_A1
	STAB CUA
	LDAB CDA
	ADDB #2
	CMPB #9
	BLS CCON_PROMO_A2
	JSR ARR_CANTC

CCON_PROMO_A2
	STAB CDA
	DEC ICONTA
	JMP CSUM_A

ARR_CANTD
	SUBB #10
	STAB CUA
	INC CDA
	LDAA CDA
	CMPA #9
	BHI ARR_CANTD1
	RTS

ARR_CANTD1
	INC CCA
	RTS

ARR_CANTC
	SUBB #10
	STAB CDA
	INC CCA
	RTS
*********************************
CSUM_B
	LDAA ICONTB
	BEQ CSUM_C
	CMPA #4
	BHI CPROMO_B2
	DEC ICONTB
	INC CCB
	JMP CSUM_B

CPROMO_B2
	LDAB CDB
	ADDB #5
	CMPB #9
	BLS CCON_PROMO_B1
	JSR BRR_CANTC

CCON_PROMO_B1
	STAB CDB
	DEC ICONTB
	JMP CSUM_B

BRR_CANTC
	SUBB #10
	STAB CDB
	INC CCB
	RTS
*********************************
CSUM_C
	LDAA ICONTC
	BEQ CSUM_D
	CMPA #4
	BHI CPROMO_C2
	DEC ICONTC
	LDAB CDC
	ADDB #5
	CMPB #9
	BLS CSIN_PROMO_C
	JSR CRR_CANTC

CSIN_PROMO_C
	STAB CDC
	JMP CSUM_C

CPROMO_C2
	LDAB CUC
	ADDB #5
	CMPB #9
	BLS CCON_PROMO_C1
	JSR CRR_CANTD

CCON_PROMO_C1
	STAB CUC
	LDAB CDC
	ADDB #2
	CMPB #9
	BLS CCON_PROMO_C2
	JSR CRR_CANTC

CCON_PROMO_C2
	STAB CDC
	DEC ICONTC
	JMP CSUM_C

CRR_CANTD
	SUBB #10
	STAB CUC
	INC CDC
	LDAA CDC
	CMPA #9
	BHI CRR_CANTD1
	RTS

CRR_CANTD1
	INC CCC
	RTS

CRR_CANTC
	SUBB #10
	STAB CDC
	INC CCC
	RTS
*********************************
CSUM_D
	LDAA ICONTD
	BEQ CSUM_E
	CMPA #4
	BHI CPROMO_D2
	DEC ICONTD
	INC CCD
	JMP CSUM_D

CPROMO_D2
	LDAB CDD
	ADDB #5
	CMPB #9
	BLS CCON_PROMO_D1
	JSR DRR_CANTC

CCON_PROMO_D1
	STAB CDD
	DEC ICONTD
	JMP CSUM_D

DRR_CANTC
	SUBB #10
	STAB CDD
	INC CCD
	RTS
*********************************
CSUM_E
	LDAA ICONTE
	BEQ CSUM_F
	CMPA #4
	BHI CPROMO_E2
	DEC ICONTE
	LDAB CDE
	ADDB #5
	CMPB #9
	BLS CSIN_PROMO_E
	JSR ERR_CANTC

CSIN_PROMO_E
	STAB CDE
	JMP CSUM_E

CPROMO_E2
	LDAA ICONTE
	BEQ CSUM_F
	LDAB CUE
	ADDB #5
	CMPB #9
	BLS CCON_PROMO_E1
	JSR ERR_CANTD

CCON_PROMO_E1
	STAB CUE
	LDAB CDE
	ADDB #2
	CMPB #9
	BLS CCON_PROMO_E2
	JSR ERR_CANTC

CCON_PROMO_E2
	STAB CDE
	DEC ICONTE
	JMP CPROMO_E2

ERR_CANTD
	SUBB #10
	STAB CUE
	INC CDE
	LDAA CDE
	CMPA #9
	BHI ERR_CANTD1
	RTS

ERR_CANTD1
	INC CCE
	RTS

ERR_CANTC
	SUBB #10
	STAB CDE
	INC CCE
	RTS
**********************************
CSUM_F
	LDAA ICONTF
	BEQ CSUM_G
	CMPA #4
	BHI CPROMO_F2
	DEC ICONTF
	INC CCF
	JMP CSUM_F

CPROMO_F2
	LDAA ICONTF
	BEQ CSUM_G
	LDAB CDF
	ADDB #5
	CMPB #9
	BLS CCON_PROMO_F1
	JSR FRR_CANTC

CCON_PROMO_F1
	STAB CDF
	DEC ICONTF
	JMP CPROMO_F2

FRR_CANTC
	SUBB #10
	STAB CDF
	INC CCF
	RTS
**********************************
CSUM_G
	LDAA ICONTG
	BEQ CSUM_H
	CMPA #4
	BHI CPROMO_G2
	DEC ICONTG
	LDAB CDG
	ADDB #5
	CMPB #9
	BLS CSIN_PROMO_G
	JSR GRR_CANTC

CSIN_PROMO_G
	STAB CDG
	JMP CSUM_G

CPROMO_G2
	LDAA ICONTG
	BEQ CSUM_H
	LDAB CUG
	ADDB #5
	CMPB #9
	BLS CCON_PROMO_G1
	JSR GRR_CANTD

CCON_PROMO_G1
	STAB CUG
	LDAB CDG
	ADDB #2
	CMPB #9
	BLS CCON_PROMO_G2
	JSR GRR_CANTC

CCON_PROMO_G2
	STAB CDG
	DEC ICONTG
	JMP CPROMO_G2

GRR_CANTD
	SUBB #10
	STAB CUG
	INC CDG
	LDAA CDG
	CMPA #9
	BHI GRR_CANTD1
	RTS

GRR_CANTD1
	INC CCG
	RTS

GRR_CANTC
	SUBB #10
	STAB CDG
	INC CCG
	RTS
**********************************
CSUM_H
	LDAA ICONTH
	BEQ CSUM_I
	CMPA #4
	BHI CPROMO_H2
	DEC ICONTH
	INC CCH
	JMP CSUM_H

CPROMO_H2
	LDAA ICONTH
	BEQ CSUM_I
	LDAB CDH
	ADDB #5
	CMPB #9
	BLS CCON_PROMO_H1
	JSR HRR_CANTC

CCON_PROMO_H1
	STAB CDH
	DEC ICONTH
	JMP CPROMO_H2

HRR_CANTC
	SUBB #10
	STAB CDH
	INC CCH
	RTS
*********************************
CSUM_I
	LDAA ICONTI
	BEQ CSUM_J
	LDAA CONTI_PROMO3
	BNE CPROMO_I2
	DEC ICONTI
	INC CONTI_PROMO3
	LDAB CDI
	ADDB #5
	CMPB #9
	BLS CSIN_PROMO_I
	JSR IRR_CANTC

CSIN_PROMO_I
	STAB CDI
	JMP CSUM_I

CPROMO_I2
	CLR CONTI_PROMO3
	LDAB CUI
	ADDB #5
	CMPB #9
	BLS CCON_PROMO_I1
	JSR IRR_CANTD

CCON_PROMO_I1
	STAB CUI
	LDAB CDI
	ADDB #2
	CMPB #9
	BLS CCON_PROMO_I2
	JSR IRR_CANTC

CCON_PROMO_I2
	STAB CDI
	DEC ICONTI
	JMP CSUM_I

IRR_CANTD
	SUBB #10
	STAB CUI
	INC CDI
	LDAA CDI
	CMPA #9
	BHI IRR_CANTD1
	RTS

IRR_CANTD1
	INC CCI
	RTS

IRR_CANTC
	SUBB #10
	STAB CDI
	INC CCI
	RTS
***********************************
CSUM_J
	LDAA ICONTJ
	BEQ CUENTA
	LDAA CONTJ_PROMO3
	BNE CPROMO_J2
	DEC ICONTJ
	INC CONTJ_PROMO3
	INC CCJ
	JMP CSUM_J

CPROMO_J2
	CLR CONTJ_PROMO3
	LDAB CDJ
	ADDB #5
	CMPB #9
	BLS CCON_PROMO_J1
	JSR JRR_CANTC

CCON_PROMO_J1
	STAB CDJ
	DEC ICONTJ
	JMP CSUM_J

JRR_CANTC
	SUBB #10
	STAB CDJ
	INC CCJ
	RTS

********************************************************
*					SUMA DE LA CUENTA				   *
********************************************************
CUENTA
	CLR U
	CLR D
	CLR C
	CLR UM
	CLR DM
	CLR CM
	CLR UMILL
	CLR DMILL
	CLR CONTI_PROMO3
	CLR CONTJ_PROMO3

UNIDADES
	LDAA U
	ADDA CUA
	ADDA CUB
	STAA U
	CMPA #9
	BLS DECENAS
	INC D
	SUBA #10
	STAA U
	JMP DECENAS
*************************************
DECENAS
	LDAA D
	ADDA CDA
	ADDA CDB
	CMPA #9
	BLS DECENAS2
	JSR AJUSTE_DECENAS

DECENAS2
	ADDA CUC
	CMPA #9
	BLS DECENAS3
	JSR AJUSTE_DECENAS

DECENAS3
	ADDA CUD
	CMPA #9
	BLS DECENAS4
	JSR AJUSTE_DECENAS

DECENAS4
	STAA D
	JMP CENTENAS

AJUSTE_DECENAS
	SUBA #10
	INC C
	RTS
************************************
CENTENAS
	LDAA C
	ADDA CCA
	CMPA #9
	BLS CENTENAS1
	JSR AJUSTE_CENTENAS

CENTENAS1
	ADDA CCB
	CMPA #9
	BLS CENTENAS2
	JSR AJUSTE_CENTENAS

CENTENAS2
	ADDA CDC
	CMPA #9
	BLS CENTENAS3
	JSR AJUSTE_CENTENAS

CENTENAS3
	ADDA CDD
	CMPA #9
	BLS CENTENAS4
	JSR AJUSTE_CENTENAS

CENTENAS4
	ADDA CUE
	CMPA #9
	BLS CENTENAS5
	JSR AJUSTE_CENTENAS

CENTENAS5
	ADDA CUF
	CMPA #9
	BLS CENTENAS6
	JSR AJUSTE_CENTENAS

CENTENAS6
	STAA C
	JMP UMILES

AJUSTE_CENTENAS
	SUBA #10
	INC UM
	RTS
*************************************
UMILES
	LDAA UM
	ADDA CCC
	CMPA #9
	BLS UMILES1
	JSR AJUSTE_UMILES

UMILES1
	ADDA CCD
	CMPA #9
	BLS UMILES2
	JSR AJUSTE_UMILES

UMILES2
	ADDA CDE
	CMPA #9
	BLS UMILES3
	JSR AJUSTE_UMILES

UMILES3
	ADDA CDF
	CMPA #9
	BLS UMILES4
	JSR AJUSTE_UMILES

UMILES4
	ADDA CUG
	CMPA #9
	BLS UMILES5
	JSR AJUSTE_UMILES

UMILES5
	ADDA CUH
	CMPA #9
	BLS UMILES6
	JSR AJUSTE_UMILES

UMILES6
	STAA UM
	JMP DMILES

AJUSTE_UMILES
	SUBA #10
	INC DM
	RTS
************************************
DMILES
	LDAA DM
	ADDA CCE
	CMPA #9
	BLS DMILES1
	JSR AJUSTE_DMILES

DMILES1
	ADDA CCF
	CMPA #9
	BLS DMILES2
	JSR AJUSTE_DMILES

DMILES2
	ADDA CDG
	CMPA #9
	BLS DMILES3
	JSR AJUSTE_DMILES

DMILES3
	ADDA CDH
	CMPA #9
	BLS DMILES4
	JSR AJUSTE_DMILES

DMILES4
	ADDA CUI
	CMPA #9
	BLS DMILES5
	JSR AJUSTE_DMILES

DMILES5
	ADDA CUJ
	CMPA #9
	BLS DMILES6
	JSR AJUSTE_DMILES

DMILES6
	STAA DM
	JMP CMILES

AJUSTE_DMILES
	SUBA #10
	INC CM
	RTS
************************************
CMILES
	LDAA CM
	ADDA CCG
	CMPA #9
	BLS CMILES1
	JSR AJUSTE_CMILES

CMILES1
	ADDA CCH
	CMPA #9
	BLS CMILES2
	JSR AJUSTE_CMILES

CMILES2
	ADDA CDI
	CMPA #9
	BLS CMILES3
	JSR AJUSTE_CMILES

CMILES3
	ADDA CDJ
	CMPA #9
	BLS CMILES4
	JSR AJUSTE_CMILES

CMILES4
	STAA CM
	JMP UMILLONES

AJUSTE_CMILES
	SUBA #10
	INC UMILL
	RTS
************************************
UMILLONES
	LDAA UMILL
	ADDA CCI
	CMPA #9
	BHI AJUSTE_UMILLONES
	ADDA CCJ
	CMPA #9
	BHI AJUSTE_UMILLONES
	STAA UMILL
	JMP IMPRESION_CUENTA

AJUSTE_UMILLONES
	SUBA #10
	STAA UMILL
	INC DMILL
	JMP ERROR_MILLONES
	
ERROR_MILLONES
	LDX #$0080
	LDY #$91D8
	JSR IMPRESION
	JMP OK
	
**********************************************************
*				IMPRESION TOTAL DE LA CUENTA			 *
**********************************************************
IMPRESION_CUENTA
	CLR DIR_IMPRALTO
	CLR DIR_IMPRBAJO
	CLR DIR_CANTALTO
	CLR DIR_CANTBAJO

	LDX #$0080
	LDY #$8F00

INICIO_A
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ CANT_A
	STAA $00,X
	INX
	JMP INICIO_A

CANT_A
	LDAA CONTA
	CMPA #9
	BLS NPA

PA
	SUBA #10
	LDAB #$31
	STAB $00,X
	INX

NPA
	ADDA #$30
	STAA $00,X
	INX

CADENA_A
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ PESOS_A
	STAA $00,X
	INX
	JMP CADENA_A

PESOS_A
	LDAA CCA
	BEQ CERO_A
	ADDA #$30
	STAA $00,X
	INX

CERO_A	LDAA CDA
	ADDA #$30
	STAA $00,X
	INX
	LDAA CUA
	ADDA #$30
	STAA $00,X
	INX

RELLENO_A
	CPX #$0090
	BEQ INICIO_B
	LDAA #$20
	STAA $00,X
	INX
	JMP RELLENO_A
********************************************
INICIO_B
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ CANT_B
	STAA $00,X
	INX
	JMP INICIO_B

CANT_B
	LDAA CONTB
	CMPA #9
	BLS NPB

PB
	SUBA #10
	LDAB #$31
	STAB $00,X
	INX

NPB
	ADDA #$30
	STAA $00,X
	INX

CADENA_B
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ PESOS_B
	STAA $00,X
	INX
	JMP CADENA_B

PESOS_B
	LDAA CCB
	ADDA #$30
	STAA $00,X
	INX
	LDAA CDB
	ADDA #$30
	STAA $00,X
	INX
	LDAA CUB
	ADDA #$30
	STAA $00,X
	INX

RELLENO_B
	CPX #$00A0
	BEQ INICIO_C
	LDAA #$20	
	STAA $00,X
	INX
	JMP RELLENO_B
********************************************
INICIO_C
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ CANT_C
	STAA $00,X
	INX
	JMP INICIO_C

CANT_C
	LDAA CONTC
	CMPA #9
	BLS NPC

PC
	SUBA #10
	LDAB #$31
	STAB $00,X
	INX

NPC
	ADDA #$30
	STAA $00,X
	INX

CADENA_C
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ PESOS_C
	STAA $00,X
	INX
	JMP CADENA_C

PESOS_C
	LDAA CCC
	BEQ CERO_C
	ADDA #$30
	STAA $00,X
	INX

CERO_C	
	LDAA CDC
	ADDA #$30
	STAA $00,X
	INX
	LDAA CUC
	ADDA #$30
	STAA $00,X
	INX
	LDAA #$30
	STAA $00,X
	INX

RELLENO_C
	CPX #$00B0
	BEQ INICIO_D
	LDAA #$20	
	STAA $00,X
	INX
	JMP RELLENO_C
*******************************************
INICIO_D
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ CANT_D
	STAA $00,X
	INX
	JMP INICIO_D

CANT_D
	LDAA CONTD
	CMPA #9
	BLS NPD

PD
	SUBA #10
	LDAB #$31
	STAB $00,X
	INX

NPD
	ADDA #$30
	STAA $00,X
	INX

CADENA_D
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ PESOS_D
	STAA $00,X
	INX
	JMP CADENA_D

PESOS_D
	LDAA CCD
	ADDA #$30
	STAA $00,X
	INX
	LDAA CDD
	ADDA #$30
	STAA $00,X
	INX
	LDAA CUD
	ADDA #$30
	STAA $00,X
	INX
	LDAA #$30
	STAA $00,X
	INX

RELLENO_D
	CPX #$00C0
	BEQ INICIO_E
	LDAA #$20	
	STAA $00,X
	INX
	JMP RELLENO_D
*******************************************
INICIO_E
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ CANT_E
	STAA $00,X
	INX
	JMP INICIO_E

CANT_E
	LDAA CONTE
	CMPA #9
	BLS NPE

PE
	SUBA #10
	LDAB #$31
	STAB $00,X
	INX

NPE
	ADDA #$30
	STAA $00,X
	INX

CADENA_E
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ PESOS_E
	STAA $00,X
	INX
	JMP CADENA_E

PESOS_E
	LDAA CCE
	BEQ CERO_E
	ADDA #$30
	STAA $00,X
	INX

CERO_E	
	LDAA CDE
	ADDA #$30
	STAA $00,X
	INX
	LDAA CUE
	ADDA #$30
	STAA $00,X
	INX
	LDAA #$30
	STAA $00,X
	INX
	STAA $00,X
	INX

RELLENO_E
	CPX #$00D0
	BEQ INICIO_F
	LDAA #$20	
	STAA $00,X
	INX
	JMP RELLENO_E
*******************************************
INICIO_F
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ CANT_F
	STAA $00,X
	INX
	JMP INICIO_F

CANT_F
	LDAA CONTF
	CMPA #9
	BLS NPF

PF
	SUBA #10
	LDAB #$31
	STAB $00,X
	INX

NPF
	ADDA #$30
	STAA $00,X
	INX

CADENA_F
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ PESOS_F
	STAA $00,X
	INX
	JMP CADENA_F

PESOS_F
	LDAA CCF
	ADDA #$30
	STAA $00,X
	INX
	LDAA CDF
	ADDA #$30
	STAA $00,X
	INX
	LDAA CUF
	ADDA #$30
	STAA $00,X
	INX
	LDAA #$30
	STAA $00,X
	INX
	STAA $00,X
	INX

RELLENO_F
	CPX #$00E0
	BEQ INICIO_G
	LDAA #$20	
	STAA $00,X
	INX
	JMP RELLENO_F
*******************************************
INICIO_G
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ CANT_G
	STAA $00,X
	INX
	JMP INICIO_G

CANT_G
	LDAA CONTG
	CMPA #9
	BLS NPG

PG
	SUBA #10
	LDAB #$31
	STAB $00,X
	INX

NPG
	ADDA #$30
	STAA $00,X
	INX

CADENA_G
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ PESOS_G
	STAA $00,X
	INX
	JMP CADENA_G

PESOS_G
	LDAA CCG
	BEQ CERO_G
	ADDA #$30
	STAA $00,X
	INX

CERO_G	
	LDAA CDG
	ADDA #$30
	STAA $00,X
	INX
	LDAA CUG
	ADDA #$30
	STAA $00,X
	INX
	LDAA #$30
	STAA $00,X
	INX
	STAA $00,X
	INX
	STAA $00,X
	INX

RELLENO_G
	CPX #$00F0
	BEQ INICIO_H
	LDAA #$20	
	STAA $00,X
	INX
	JMP RELLENO_G
********************************************
INICIO_H
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ CANT_H
	STAA $00,X
	INX
	JMP INICIO_H

CANT_H
	LDAA CONTH
	CMPA #9
	BLS NPH

PH
	SUBA #10
	LDAB #$31
	STAB $00,X
	INX

NPH
	ADDA #$30
	STAA $00,X
	INX

CADENA_H
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ PESOS_H
	STAA $00,X
	INX
	JMP CADENA_H

PESOS_H
	LDAA CCH
	ADDA #$30
	STAA $00,X
	INX
	LDAA CDH
	ADDA #$30
	STAA $00,X
	INX
	LDAA CUH
	ADDA #$30
	STAA $00,X
	INX
	LDAA #$30
	STAA $00,X
	INX
	STAA $00,X
	INX
	STAA $00,X
	INX

RELLENO_H
	CPX #$0100
	BEQ INICIO_I
	LDAA #$20	
	STAA $00,X
	INX
	JMP RELLENO_H
********************************************
INICIO_I
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ CANT_I
	STAA $00,X
	INX
	JMP INICIO_I

CANT_I
	LDAA CONTI
	CMPA #9
	BLS NPI

PI
	SUBA #10
	LDAB #$31
	STAB $00,X
	INX

NPI
	ADDA #$30
	STAA $00,X
	INX

CADENA_I
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ PESOS_I
	STAA $00,X
	INX
	JMP CADENA_I

PESOS_I
	LDAA CCI
	BEQ CERO_I
	ADDA #$30
	STAA $00,X
	INX

CERO_I	
	LDAA CDI
	ADDA #$30
	STAA $00,X
	INX
	LDAA CUI
	ADDA #$30
	STAA $00,X
	INX
	LDAA #$30
	STAA $00,X
	INX
	STAA $00,X
	INX
	STAA $00,X
	INX
	STAA $00,X
	INX

RELLENO_I
	CPX #$0110
	BEQ INICIO_J
	LDAA #$20	
	STAA $00,X
	INX
	JMP RELLENO_I
*********************************************
INICIO_J
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ CANT_J
	STAA $00,X
	INX
	JMP INICIO_J

CANT_J
	LDAA CONTJ
	CMPA #9
	BLS NPJ

PJ
	SUBA #10
	LDAB #$31
	STAB $00,X
	INX

NPJ
	ADDA #$30
	STAA $00,X
	INX

CADENA_J
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ PESOS_J
	STAA $00,X
	INX
	JMP CADENA_J

PESOS_J
	LDAA CCJ
	ADDA #$30
	STAA $00,X
	INX
	LDAA CDJ
	ADDA #$30
	STAA $00,X
	INX
	LDAA CUJ
	ADDA #$30
	STAA $00,X
	INX
	LDAA #$30
	STAA $00,X
	INX
	STAA $00,X
	INX
	STAA $00,X
	INX
	STAA $00,X
	INX

RELLENO_J
	CPX #$0120
	BEQ IMPRESION_TOTAL
	LDAA #$20	
	STAA $00,X
	INX
	JMP RELLENO_J

*******************************************************************
*			 IMPRESION TOTAL DE LA CUENTA CANTIDAD			  	  *
*******************************************************************
IMPRESION_TOTAL
	CLR CONT_ANT
	LDY #$8F50

INICIO_IMPR_TOTAL
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ IMPR_UMILLONES
	STAA $00,X
	INX
	JMP INICIO_IMPR_TOTAL

IMPR_UMILLONES
	LDAA UMILL
	BEQ IMPR_CMILES
	ADDA #$30
	STAA $00,X
	INX
	LDAA #',
	STAA $00,X
	INX
	INC CONT_ANT
****************************************
IMPR_CMILES
	LDAA CM
	BEQ ANTERIOR

ANT_OK	
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_DMILES

ANTERIOR
	LDAB CONT_ANT
	BEQ IMPR_DMILES
	JMP ANT_OK
******************************************
IMPR_DMILES
	LDAA DM
	BEQ ANTERIOR1

ANT_OK1	
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_UMILES

ANTERIOR1
	LDAB CONT_ANT
	BEQ IMPR_UMILES
	JMP ANT_OK1
*************************************
IMPR_UMILES
	LDAA UM
	BEQ ANTERIOR2

ANT_OK2	
	ADDA #$30
	STAA $00,X
	INX
	LDAA #',
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_CENTENAS

ANTERIOR2
	LDAB CONT_ANT
	BEQ IMPR_CENTENAS
	JMP ANT_OK2
**************************************
IMPR_CENTENAS
	LDAA C
	BEQ ANTERIOR3

ANT_OK3	
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_DECENAS

ANTERIOR3
	LDAB CONT_ANT
	BEQ IMPR_DECENAS
	JMP ANT_OK3
***************************************
IMPR_DECENAS
	LDAA D
	BEQ ANTERIOR4

ANT_OK4	
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_UNIDADES

ANTERIOR4
	LDAB CONT_ANT
	BEQ IMPR_UNIDADES
	JMP ANT_OK4
**************************************
IMPR_UNIDADES
	LDAA U
	BEQ IMPR_CERO
	ADDA #$30
	STAA $00,X
	INX
	JMP CALC_AHORRO
	*JMP CALC_IVA
	
IMPR_CERO
	LDAA #$30
	STAA $00,X
	INX

*****************************************************************
*					      CALCULO AHORRO	       				*
*****************************************************************
CALC_AHORRO
	CLR AHR_U
	CLR AHR_D
	CLR AHR_C
	CLR AHR_UM
	CLR AHR_DM
	CLR AHR_CM
	CLR AHR_UMILL
	CLR AHR_AUX
	CLR AHR_AA
	CLR AHR_AB
	CLR AHR_AC
	CLR AHR_AD
	CLR AHR_AE
	CLR AHR_AF
	CLR AHR_AG
	CLR AHR_AH
	CLR AHR_AI
	CLR AHR_AJ

	LDAA CONTA
	STAA AHR_AA
	LDAA CONTB
	STAA AHR_AB
	LDAA CONTC
	STAA AHR_AC
	LDAA CONTD
	STAA AHR_AD
	LDAA CONTE
	STAA AHR_AE
	LDAA CONTF
	STAA AHR_AF
	LDAA CONTG
	STAA AHR_AG
	LDAA CONTH
	STAA AHR_AH
	LDAA CONTI
	STAA AHR_AI
	LDAA CONTJ
	STAA AHR_AJ

AHORRO_A
	LDAA AHR_AA
	CMPA #4
	BHI AHORRO_A2
	JMP AHORRO_B
AHORRO_A2
	LDAB AHR_D
	ADDB #2
	CMPB #9
	STAB AHR_D
	BHI AHORRO_AJUSTE_A2
	JMP AHORRO_A3
AHORRO_A3
	LDAA AHR_U
	ADDA #5
	CMPA #9
	STAA AHR_U
	BHI AHORRO_AJUSTE_A
	DEC AHR_AA
	JMP AHORRO_A
AHORRO_AJUSTE_A
	DEC AHR_AA
	INC AHR_D
	LDAA AHR_U
	SUBA #10
	STAA AHR_U
	JMP AHORRO_A
AHORRO_AJUSTE_A2
	INC AHR_C
	LDAA AHR_D
	SUBA #10
	STAA AHR_D
	JMP AHORRO_A3
*********************************************
AHORRO_B
	LDAA AHR_AB
	CMPA #4
	BHI AHORRO_B2
	JMP AHORRO_C
AHORRO_B2
	LDAA AHR_D
	ADDA #5
	CMPA #9
	STAA AHR_D
	BHI AHORRO_AJUSTE_B
	DEC AHR_AB
	JMP AHORRO_B
AHORRO_AJUSTE_B
	DEC AHR_AB
	INC AHR_C
	LDAA AHR_D
	SUBA #10
	STAA AHR_D
	JMP AHORRO_B
*********************************************
AHORRO_C
	LDAA AHR_AC
	CMPA #4
	BHI AHORRO_C2
	JMP AHORRO_D
AHORRO_C2
	LDAB AHR_C
	ADDB #2
	CMPB #9
	STAB AHR_C
	BHI AHORRO_AJUSTE_C2
	JMP AHORRO_C3
AHORRO_C3
	LDAA AHR_D
	ADDA #5
	CMPA #9
	STAA AHR_D
	BHI AHORRO_AJUSTE_C
	DEC AHR_AC
	JMP AHORRO_C
AHORRO_AJUSTE_C
	DEC AHR_AC
	INC AHR_C
	LDAA AHR_D
	SUBA #10
	STAA AHR_D
	JMP AHORRO_C
AHORRO_AJUSTE_C2
	INC AHR_UM
	LDAA AHR_C
	SUBA #10
	STAA AHR_C
	JMP AHORRO_C3
*********************************************
AHORRO_D
	LDAA AHR_AD
	CMPA #4
	BHI AHORRO_D2
	JMP AHORRO_E
AHORRO_D2
	LDAA AHR_C
	ADDA #5
	CMPA #9
	STAA AHR_C
	BHI AHORRO_AJUSTE_D
	DEC AHR_AD
	JMP AHORRO_D
AHORRO_AJUSTE_D
	DEC AHR_AD
	INC AHR_UM
	LDAA AHR_C
	SUBA #10
	STAA AHR_C
	JMP AHORRO_D
*********************************************
AHORRO_E
	LDAA AHR_AE
	CMPA #4
	BHI AHORRO_E2
	JMP AHORRO_F
AHORRO_E2
	LDAA AHR_AE 
	CMPA #0
	BEQ AHORRO_F
	LDAA AHR_UM
	ADDA #2
	CMPA #9
	STAA AHR_UM
	BHI AHORRO_AJUSTE_E2
	JMP AHORRO_E3
AHORRO_E3
	LDAA AHR_C
	ADDA #5
	CMPA #9
	STAA AHR_C
	BHI AHORRO_AJUSTE_E
	DEC AHR_AE
	JMP AHORRO_E2
AHORRO_AJUSTE_E
	DEC AHR_AE
	INC AHR_UM
	LDAA AHR_C
	SUBA #10
	STAA AHR_C
	JMP AHORRO_E2
AHORRO_AJUSTE_E2
	INC AHR_DM
	LDAA AHR_UM
	SUBA #10
	STAA AHR_UM
	JMP AHORRO_E3
********************************************
AHORRO_F
	LDAA AHR_AF
	CMPA #4
	BHI AHORRO_F2
	JMP AHORRO_G
AHORRO_F2
	LDAA AHR_AF
	CMPA #0
	BEQ AHORRO_G
	
	LDAA AHR_UM
	ADDA #5
	CMPA #9
	STAA AHR_UM
	BHI AHORRO_AJUSTE_F
	
	DEC AHR_AF
	JMP AHORRO_F2
AHORRO_AJUSTE_F
	DEC AHR_AF
	INC AHR_DM
	LDAA AHR_UM
	SUBA #10
	STAA AHR_UM
	JMP AHORRO_F2
*********************************************
AHORRO_G
	LDAA AHR_AG
	CMPA #4
	BHI AHORRO_G2
	JMP AHORRO_H
AHORRO_G2
	LDAA AHR_AG
	CMPA #0
	BEQ AHORRO_H
	LDAA AHR_DM 
	ADDA #2
	CMPA #9
	STAA AHR_DM
	BHI AHORRO_AJUSTE_G2
	JMP AHORRO_G3
AHORRO_G3
	LDAA AHR_UM
	ADDA #5
	CMPA #9
	STAA AHR_UM
	BHI AHORRO_AJUSTE_G
	DEC AHR_AG
	JMP AHORRO_G2
AHORRO_AJUSTE_G
	DEC AHR_AG
	INC AHR_DM 
	LDAA AHR_UM
	SUBA #10
	STAA AHR_UM
	JMP AHORRO_G2
AHORRO_AJUSTE_G2
	INC AHR_CM
	LDAA AHR_DM
	SUBA #10
	STAA AHR_DM
	JMP AHORRO_G3
*********************************************
AHORRO_H
	LDAA AHR_AH
	CMPA #4
	BHI AHORRO_H2
	JMP AHORRO_I
AHORRO_H2
	LDAA AHR_AH
	CMPA #0
	BEQ AHORRO_I

	LDAA AHR_DM
	ADDA #5
	CMPA #9
	STAA AHR_DM
	BHI AHORRO_AJUSTE_H

	DEC AHR_AH
	JMP AHORRO_H2
AHORRO_AJUSTE_H
	DEC AHR_AH
	INC AHR_CM
	LDAA AHR_DM
	SUBA #10
	STAA AHR_DM
	JMP AHORRO_H2
**********************************************
AHORRO_I
	LDAA AHR_AI
	CMPA #1
	BHI AHORRO_I2
	JMP AHORRO_J
AHORRO_I2
	DEC AHR_AI
	DEC AHR_AI
	LDAA AHR_CM
	ADDA #2
	CMPA #9
	STAA AHR_CM
	BHI AHORRO_AJUSTE_I2
	JMP AHORRO_I3
AHORRO_I3
	LDAA AHR_DM
	ADDA #5
	CMPA #9
	STAA AHR_DM
	BHI AHORRO_AJUSTE_I
	JMP AHORRO_I
AHORRO_AJUSTE_I2
	INC AHR_UMILL
	LDAA AHR_CM
	SUBA #10
	STAA AHR_CM
	JMP AHORRO_I3
AHORRO_AJUSTE_I
	INC AHR_CM
	LDAA AHR_DM
	SUBA #10
	STAA AHR_DM
	JMP AHORRO_I
*********************************************
AHORRO_J
	LDAA AHR_AJ
	CMPA #1
	BHI AHORRO_J2
	JMP IMPRESION_AHORRO
AHORRO_J2
	DEC AHR_AJ
	DEC AHR_AJ
	LDAA AHR_CM 
	ADDA #5
	CMPA #9
	STAA AHR_CM
	BHI AHORRO_AJUSTE_J
	JMP AHORRO_J
AHORRO_AJUSTE_J
	INC AHR_UMILL
	LDAA AHR_CM
	SUBA #10
	STAA AHR_CM
	JMP AHORRO_J

*****************************************************************
*					      IMPRESION AHORRO	    				*
*****************************************************************
IMPRESION_AHORRO
	CLR CONT_ANT
	LDX #$0140
	LDY #$9530
INICIO_IMPR_AHORRO
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ IMPR_UMILL_AHORRO
	STAA $00,X
	INX
	JMP INICIO_IMPR_AHORRO
IMPR_UMILL_AHORRO
	LDAA AHR_UMILL
	BEQ IMPR_CMILES_AHORRO
	ADDA #$30
	STAA $00,X
	INX
	LDAA #',
	STAA $00,X
	INX
	INC CONT_ANT
*******************************************
IMPR_CMILES_AHORRO
	LDAA AHR_CM
	BEQ ANTERIOR_AHR
ANT_OK_AHR
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_DMILES_AHORRO
ANTERIOR_AHR
	LDAB CONT_ANT
	BEQ IMPR_DMILES_AHORRO
	JMP ANT_OK_AHR
*******************************************
IMPR_DMILES_AHORRO
	LDAA AHR_DM
	BEQ ANTERIOR_AHR2
ANT_OK_AHR2
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_UMILES_AHORRO
ANTERIOR_AHR2
	LDAB CONT_ANT
	BEQ IMPR_UMILES_AHORRO
	JMP ANT_OK_AHR2
*******************************************
IMPR_UMILES_AHORRO
	LDAA AHR_UM
	BEQ ANTERIOR_AHR3
ANT_OK_AHR3
	ADDA #$30
	STAA $00,X
	INX
	LDAA #',
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_CENTENAS_AHORRO
ANTERIOR_AHR3
	LDAB CONT_ANT
	BEQ IMPR_CENTENAS_AHORRO
	JMP ANT_OK_AHR3
******************************************
IMPR_CENTENAS_AHORRO
	LDAA AHR_C
	BEQ ANTERIOR_AHR4
ANT_OK_AHR4
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_DECENAS_AHORRO
ANTERIOR_AHR4
	LDAB CONT_ANT
	BEQ IMPR_DECENAS_AHORRO
	JMP ANT_OK_AHR4
****************************************
IMPR_DECENAS_AHORRO
	LDAA AHR_D
	BEQ ANTERIOR_AHR5
ANT_OK_AHR5
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_UNIDADES_AHORRO
ANTERIOR_AHR5
	LDAB CONT_ANT
	BEQ IMPR_UNIDADES_AHORRO
	JMP ANT_OK_AHR5
****************************************
IMPR_UNIDADES_AHORRO
	LDAA U
	BEQ IMPR_CERO_AHR
	ADDA #$30
	STAA $00,X
	INX
	JMP CALC_IVA
IMPR_CERO_AHR
	LDAA #$30
	STAA $00,X
	INX

*****************************************************************
*					      IMPRESION IVA	        				*
*****************************************************************
CALC_IVA
	CLR CONT_IVA 
	CLR IVADCENT 
	CLR IVAU 
	CLR IVAD 
	CLR IVAC 
	CLR IVAUM 
	CLR IVADM 
	CLR IVACM 
	CLR IVAUMILL 
	CLR IVADMILL 

	LDAA U
	STAA IVADCENT
	LDAA D
	STAA IVAU
	LDAA C
	STAA IVAD
	LDAA UM
	STAA IVAC
	LDAA DM
	STAA IVAUM
	LDAA CM
	STAA IVADM

IMPRESION_IVA_TOTAL
	LDX #$0160
	LDY #$9170

INICIO_IMPR_IVA
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ IMPR_IVA_DM
	STAA $00,X
	INX
	JMP INICIO_IMPR_IVA

IMPR_IVA_DM
	LDAA IVADM
	BEQ IMPR_IVA_UM
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_IVA
***************************************
IMPR_IVA_UM
	LDAA IVAUM
	BEQ ANTERIOR6
IVA_OK2
	ADDA #$30
	STAA $00,X
	INX
	LDAA #',
	STAA $00,X
	INX
	INC CONT_IVA
	JMP IMPR_IVA_C
ANTERIOR6
	LDAB CONT_IVA
	BEQ IMPR_IVA_C
	JMP IVA_OK2
**************************************
IMPR_IVA_C
	LDAA IVAC
	BEQ ANTERIOR7
IVA_OK3
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_IVA
	JMP IMPR_IVA_D
ANTERIOR7
	LDAB CONT_IVA
	BEQ IMPR_IVA_D
	JMP IVA_OK3
**************************************
IMPR_IVA_D
	LDAA IVAD
	BEQ ANTERIOR8
IVA_OK4
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_IVA
	JMP IMPR_IVA_U
ANTERIOR8
	LDAB CONT_IVA
	BEQ  IMPR_IVA_U
	JMP IVA_OK4
*************************************
IMPR_IVA_U
	LDAA IVAU
	BEQ ANTERIOR10
IVA_OK6
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_IVA
	JMP IMPR_PUNTO
ANTERIOR10
	LDAB CONT_IVA
	BEQ IMPR_PUNTO
	JMP IVA_OK6
*************************************
IMPR_PUNTO
	LDY #$9160
	JSR IMPRESION_PUNTO
	JMP IMPR_IVA_CENTD

IMPRESION_PUNTO
	LDAB $00,Y
	INY
	CMPB #'|
	BNE IMPRESION_CONT_IVA
	RTS

IMPRESION_CONT_IVA
	STAB $00,X
	INX
	JMP IMPRESION_PUNTO

*************************************
IMPR_IVA_CENTD
	LDAA IVADCENT
	BEQ IMPR_CERO_IVA
	ADDA #$30
	STAA $00,X
	INX
	JMP SUMA_FINAL
IMPR_CERO_IVA
	LDAA #$30
	STAA $00,X
	INX

****************************************************************
*			 			SUMA IVA+TOTAL						   *
****************************************************************
SUMA_FINAL
	LDAA U
	LDAB IVAU
	ABA
	CMPA #9
	BHI AJUSTE_FINAL
	STAA U
	JMP SUMA_FINAL2

AJUSTE_FINAL
	LDAB #10
	SBA
	STAA U
	
	LDAA IVAD
	LDAB #1
	ABA
	STAA IVAD
	JMP SUMA_FINAL2

SUMA_FINAL2
	LDAA D
	LDAB IVAD
	ABA
	CMPA #9
	BHI AJUSTE_FINAL2
	STAA D
	JMP SUMA_FINAL3

AJUSTE_FINAL2
	LDAB #10
	SBA
	STAA D
	
	LDAA IVAC
	LDAB #1
	ABA
	STAA IVAC
	JMP SUMA_FINAL3

SUMA_FINAL3
	LDAA C
	LDAB IVAC
	ABA
	CMPA #9
	BHI AJUSTE_FINAL3
	STAA C
	JMP SUMA_FINAL4

AJUSTE_FINAL3
	LDAB #10
	SBA
	STAA C
	
	LDAA IVAUM
	LDAB #1
	ABA
	STAA IVAUM
	JMP SUMA_FINAL4

SUMA_FINAL4
	LDAA UM
	LDAB IVAUM
	ABA
	CMPA #9
	BHI AJUSTE_FINAL4
	STAA UM
	JMP SUMA_FINAL5

AJUSTE_FINAL4
	LDAB #10
	SBA
	STAA UM
	
	LDAA IVADM
	LDAB #1
	ABA
	STAA IVADM
	JMP SUMA_FINAL5

SUMA_FINAL5
	LDAA DM
	LDAB IVADM
	ABA
	CMPA #9
	BHI AJUSTE_FINAL5
	STAA DM
	JMP SUMA_FINAL6

AJUSTE_FINAL5
	LDAB #10
	SBA
	STAA DM
	
	LDAA IVACM
	LDAB #1
	ABA
	STAA IVACM
	JMP SUMA_FINAL6

SUMA_FINAL6
	LDAA CM
	LDAB IVACM
	ABA
	CMPA #9
	BHI AJUSTE_FINAL6
	STAA CM
	JMP SUMA_FINAL7

AJUSTE_FINAL6
	LDAB #10
	SBA
	STAA CM
	
	LDAA IVAUMILL
	LDAB #1
	ABA
	STAA IVAUMILL
	JMP SUMA_FINAL7

SUMA_FINAL7
	LDAA UMILL
	LDAB IVAUMILL
	ABA
	CMPA #9
	BHI ERROR_MILLONES2
	STAA UMILL
	JMP IMPRESION_FINAL
ERROR_MILLONES2
	JMP ERROR_MILLONES

**********************************************************************
* 							IMPRESION FINAL							 *
**********************************************************************
IMPRESION_FINAL
	CLR CONT_ANT
	LDX #$0180
	LDY #$9180

INICIO_IMPR_FINAL
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ IMPR_UMILLONES_F
	STAA $00,X
	INX
	JMP INICIO_IMPR_FINAL

IMPR_UMILLONES_F
	LDAA UMILL
	BEQ IMPR_CMILES_F
	ADDA #$30
	STAA $00,X
	INX
	LDAA #',
	STAA $00,X
	INX
	INC CONT_ANT
********************************************
IMPR_CMILES_F
	LDAA CM
	BEQ ANTERIOR20

ANT_OK20	
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_DMILES_F

ANTERIOR20
	LDAB CONT_ANT
	BEQ IMPR_DMILES_F
	JMP ANT_OK20
******************************************
IMPR_DMILES_F
	LDAA DM
	BEQ ANTERIOR21

ANT_OK21	
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_UMILES_F

ANTERIOR21
	LDAB CONT_ANT
	BEQ IMPR_UMILES_F
	JMP ANT_OK21
*************************************
IMPR_UMILES_F
	LDAA UM
	BEQ ANTERIOR22

ANT_OK22
	ADDA #$30
	STAA $00,X
	INX
	LDAA #',
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_CENTENAS_F

ANTERIOR22
	LDAB CONT_ANT
	BEQ IMPR_CENTENAS_F
	JMP ANT_OK22
**************************************
IMPR_CENTENAS_F
	LDAA C
	BEQ ANTERIOR23

ANT_OK23	
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_DECENAS_F

ANTERIOR23
	LDAB CONT_ANT
	BEQ IMPR_DECENAS_F
	JMP ANT_OK23
***************************************
IMPR_DECENAS_F
	LDAA D
	BEQ ANTERIOR24	*resta igual a 0

ANT_OK24	
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_UNIDADES_F

ANTERIOR24
	LDAB CONT_ANT
	BEQ IMPR_UNIDADES_F
	JMP ANT_OK24
**************************************
IMPR_UNIDADES_F
	LDAA U
	BEQ ANTERIOR25	*resta igual a 0

ANT_OK25	
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_PUNTO_F

ANTERIOR25
	LDAB CONT_ANT
	BEQ IMPR_PUNTO_F
	JMP ANT_OK25
**************************************
IMPR_PUNTO_F
	LDY #$9160
	JSR IMPRESION_PUNTO_F
	JMP IMPR_IVA_CENTD_F

IMPRESION_PUNTO_F
	LDAB $00,Y
	INY
	CMPB #'|
	BNE IMPRESION_CONT_IVA_F
	RTS

IMPRESION_CONT_IVA_F
	STAB $00,X
	INX
	JMP IMPRESION_PUNTO_F
**************************************
IMPR_IVA_CENTD_F
	LDAA IVADCENT
	BEQ ANTERIOR26
ANT_OK26
	ADDA #$30
	STAA $00,X
	INX
	INC CONT_ANT
	JMP IMPR_PARENTESIS
ANTERIOR26
	LDAB CONT_ANT
	BEQ IMPR_PARENTESIS
	JMP ANT_OK26
**************************************
IMPR_PARENTESIS
	LDX #$01A0
	LDY #$93F0
	JSR IMPRESION_PARENTESIS
	JMP IMPRIMIR_PALABRAS

IMPRESION_PARENTESIS
	LDAB $00,Y
	INY
	CMPB #'|
	BNE IMPRESION_CONT_IVA_2
	RTS

IMPRESION_CONT_IVA_2
	STAB $00,X
	INX
	JMP IMPRESION_PARENTESIS

*************************************************************************
*							IMPRESION EN LETRA    				  		*
*************************************************************************
IMPRIMIR_PALABRAS
	CLR CONT_MAYUS
	CLR CONT_THOUSAND	
	CLR CONT_GUION
	CLR CONT_AND
	CLR CONT_COMA

	LDX #$01A1
	
	LDAA $00,Y
	INY
	CMPA #'|
	BEQ UNO_UMILLONES
	STAA $00,X
	INX
	JMP IMPRIMIR_PALABRAS

UNO_UMILLONES
	LDAA UMILL
	BEQ UNO_CMILESRANA
	CMPA #1
	BNE DOS_UMILLONES
	INC CONT_MAYUS
	LDY #$8F60 			*Un 
	JSR IMPRESION
	LDY #$9110
	JSR IMPRESION
	JMP INTER_CEROS_CM
	
UNO_CMILESRANA
	JMP UNO_CMILES

DOS_UMILLONES
	LDAA UMILL
	CMPA #2
	BNE TRES_UMILLONES
	INC CONT_MAYUS
	LDY #$8F68
	JSR IMPRESION
	JMP MILLIONS

TRES_UMILLONES
	LDAA UMILL
	CMPA #3
	BNE CUATRO_UMILLONES
	INC CONT_MAYUS
	LDY #$8F70
	JSR IMPRESION
	JMP MILLIONS

CUATRO_UMILLONES
	LDAA UMILL
	CMPA #4
	BNE CINCO_UMILLONES
	INC CONT_MAYUS
	LDY #$8F78
	JSR IMPRESION
	JMP MILLIONS

CINCO_UMILLONES
	LDAA UMILL
	CMPA #5
	BNE SEIS_UMILLONES
	INC CONT_MAYUS
	LDY #$8F80
	JSR IMPRESION
	JMP MILLIONS

SEIS_UMILLONES
	LDAA UMILL
	CMPA #6
	BNE SIETE_UMILLONES
	INC CONT_MAYUS
	LDY #$8F88
	JSR IMPRESION
	JMP MILLIONS

SIETE_UMILLONES
	LDAA UMILL
	CMPA #7
	BNE OCHO_UMILLONES
	INC CONT_MAYUS
	LDY #$8F90
	JSR IMPRESION
	JMP MILLIONS

OCHO_UMILLONES
	LDAA UMILL
	CMPA #8
	BNE NUEVE_UMILLONES
	INC CONT_MAYUS
	LDY #$8F98
	JSR IMPRESION
	JMP MILLIONS

NUEVE_UMILLONES
	INC CONT_MAYUS
	LDY #$8FA0
	JSR IMPRESION
	JMP MILLIONS

MILLI
	LDY #$9110
	JSR IMPRESION

MILLIONS
	LDY #$8FA7
	JSR IMPRESION
*********************************************
INTER_CEROS_CM
	LDAA CM
	CMPA #0
	BEQ INTER_CEROS_DM
	JMP UNO_CMILES
INTER_CEROS_DM
	LDAA DM
	CMPA #0
	BEQ INTER_CEROS_UM
	JMP UNO_DMILES
INTER_CEROS_UM
	LDAA UM
	CMPA #0
	BEQ INTER_CEROS_C
	JMP UNO_UMILES
INTER_CEROS_C
	LDAA C
	CMPA #0
	BEQ INTER_CEROS_D
	JMP UNO_CENTENAS
INTER_CEROS_D
	LDAA D
	CMPA #0
	BEQ INTER_CEROS_U
	JMP UNO_DECENAS
INTER_CEROS_U
	LDAA UM
	CMPA #0
	BEQ INTER_DOLLARS
	JMP CERO_UNIDADES
INTER_DOLLARS
	JMP DOLLARS

UNO_CMILES
	CLR CONT_COMA
	LDAB CONT_MAYUS
	BEQ UNO_CMILES_OK
	INC CONT_COMA
	JMP NO_COMA

UNO_CMILES_OK
	LDAA CM
	BEQ UNO_DMILESRANA

NO_COMA
	INC CONT_AND
	INC CONT_THOUSAND
	CMPA #1
	BNE DOS_CMILES
	LDY #$9130
	LDAB CONT_MAYUS
	BEQ UNO_CMILES_N
	JSR IMPRESION_MINUS

UNO_CMILES_N
	INC CONT_MAYUS
	JSR IMPRESION

UNO_DMILESRANA
	JMP INTER_CEROS_DM
	*JMP UNO_DMILES

DOS_CMILES
	LDAA CM
	CMPA #2
	BNE TRES_CMILES
	LDY #$8F68
	LDAB CONT_MAYUS
	BEQ DOS_CMILES_N
	JSR IMPRESION_MINUS
DOS_CMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP HUNDRED
	
TRES_CMILES
	LDAA CM
	CMPA #3
	BNE CUATRO_CMILES
	LDY #$8F70
	LDAB CONT_MAYUS
	BEQ TRES_CMILES_N
	JSR IMPRESION_MINUS
TRES_CMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP HUNDRED
	
CUATRO_CMILES
	LDAA CM
	CMPA #4
	BNE CINCO_CMILES
	LDY #$8F78
	LDAB CONT_MAYUS
	BEQ CUATRO_CMILES_N
	JSR IMPRESION_MINUS
CUATRO_CMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP HUNDRED
	
CINCO_CMILES
	LDAA CM
	CMPA #5
	BNE SEIS_CMILES
	LDY #$9120
	LDAB CONT_MAYUS
	BEQ CINCO_CMILES_N
	JSR IMPRESION_MINUS
	JMP INTER_CEROS_DM2
CINCO_CMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP INTER_CEROS_DM2
	
SEIS_CMILES
	LDAA CM
	CMPA #6
	BNE SIETE_CMILES
	LDY #$8F88
	LDAB CONT_MAYUS
	BEQ SEIS_CMILES_N
	JSR IMPRESION_MINUS
SEIS_CMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP HUNDRED
	
SIETE_CMILES
	LDAA CM
	CMPA #7
	BNE OCHO_CMILES
	LDY #$9140
	LDAB CONT_MAYUS
	BEQ SIETE_CMILES_N
	JSR IMPRESION_MINUS
SIETE_CMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP HUNDRED

OCHO_CMILES
	LDAA CM
	CMPA #8
	BNE NUEVE_CMILES_INTER
	LDY #$8F98
	LDAB CONT_MAYUS
	BEQ OCHO_CMILES_N
	JSR IMPRESION_MINUS
OCHO_CMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP HUNDRED
	
NUEVE_CMILES_INTER
	LDAA CM
	CMPA #9
	BEQ NUEVE_CMILES
	JMP UNO_DMILES

NUEVE_CMILES
	LDY #$911B
	LDAB CONT_MAYUS
	BEQ NUEVE_CMILES_N
	JSR IMPRESION_MINUS
NUEVE_CMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP HUNDRED
	
HUNDRED
	LDY #$8FB8		*cientos
	JSR IMPRESION 
******************************************
INTER_CEROS_DM2
	LDAA DM
	CMPA #0
	BEQ INTER_CEROS_UM2
	JMP UNO_DMILES
INTER_CEROS_UM2
	LDAA UM
	CMPA #0
	BEQ INTER_CEROS_C2
	JMP UNO_UMILES
INTER_CEROS_C2
	LDAA C
	CMPA #0
	BEQ INTER_CEROS_D2
	JMP UNO_CENTENAS
INTER_CEROS_D2
	LDAA D
	CMPA #0
	BEQ INTER_CEROS_U2
	JMP UNO_DECENAS
INTER_CEROS_U2
	LDAA UM
	CMPA #0
	BEQ INTER_DOLLARS2
	JMP CERO_UNIDADES
INTER_DOLLARS2
	JMP DOLLARS

UNO_DMILES
	LDAA DM
	BEQ UNO_UMILESRANA
	JMP UNO_DMILES_OK

COMA1
	LDAB CONT_COMA
	CLR CONT_COMA
	LDY #$9080
	JSR IMPRESION

UNO_DMILES_OK
	INC CONT_GUION
	INC CONT_THOUSAND
	CMPA #1
	BNE DOS_DMILESRANA
	LDAB UM
	BEQ DIEZ
	CMPB #1
	BNE DOCE

ONCE
	LDY #$8FF8
	LDAB CONT_MAYUS
	BEQ ONCE_N
	JSR IMPRESION_MINUS
ONCE_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

UNO_UMILESRANA
	JMP UNO_UMILES
DOS_DMILESRANA
	JMP DOS_DMILES_PUENTE
DIEZ
	LDY #$8FF0
	LDAB CONT_MAYUS
	BEQ DIEZ_N
	JSR IMPRESION_MINUS
DIEZ_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

DOCE
	LDAB UM
	CMPB #2
	BNE TRECE
	LDY #$9000
	LDAB CONT_MAYUS
	BEQ DOCE_N
	JSR IMPRESION_MINUS
DOCE_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

TRECE
	LDAB UM
	CMPB #3
	BNE CATORCE
	LDY #$9010
	LDAB CONT_MAYUS
	BEQ TRECE_N
	JSR IMPRESION_MINUS
TRECE_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

CATORCE
	LDAB UM
	CMPB #4
	BNE QUINCE
	LDY #$9020
	LDAB CONT_MAYUS
	BEQ CATORCE_N
	JSR IMPRESION_MINUS
CATORCE_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

QUINCE
	LDAB UM
	CMPB #5
	BNE DIECISEIS
	LDY #$9030
	LDAB CONT_MAYUS
	BEQ QUINCE_N
	JSR IMPRESION_MINUS
QUINCE_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

DIECISEIS
	LDAB UM
	CMPB #6
	BNE DIECISIETE
	LDY #$9040
	LDAB CONT_MAYUS
	BEQ DIECISEIS_N
	JSR IMPRESION_MINUS
DIECISEIS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

DIECISIETE
	LDAB UM
	CMPB #7
	BNE DIECIOCHO
	LDY #$9050
	LDAB CONT_MAYUS
	BEQ DIECISIETE_N
	JSR IMPRESION_MINUS
DIECISIETE_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

DIECIOCHO
	LDAB UM
	CMPB #8
	BNE DIECINUEVE
	LDY #$9060
	LDAB CONT_MAYUS
	BEQ DIECIOCHO_N
	JSR IMPRESION_MINUS
DIECIOCHO_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

DIECINUEVE
	LDY #$9070			*MENSAJE
	LDAB CONT_MAYUS
	BEQ DIECINUEVE_N
	JSR IMPRESION_MINUS
DIECINUEVE_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

DOS_DMILES_PUENTE
	JMP DOS_DMILES

**************************************************************
*						SIGUE DOS DMILES					 *
**************************************************************
DOS_DMILES
	LDAA DM
	CMPA #2
	BNE TRES_DMILES_PUENTE
	LDAB UM
	CMPB #0
	BHI VEINTIUNO
	LDY #$9088
	LDAB CONT_MAYUS
	BEQ DOS_DMILES_N
	JSR IMPRESION_MINUS
DOS_DMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND
	
TRES_DMILES_PUENTE
	JMP TRES_DMILES

VEINTIUNO
	LDAB UM
	CMPB #1
	BHI VEINTIDOS
	LDY #$9260
	LDAB CONT_MAYUS
	BEQ VEINTIUNO_N
	JSR IMPRESION_MINUS
VEINTIUNO_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

VEINTIDOS
	LDAB UM
	CMPB #2
	BHI VEINTITRES
	LDY #$9270
	LDAB CONT_MAYUS
	BEQ VEINTIDOS_N
	JSR IMPRESION_MINUS
VEINTIDOS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

VEINTITRES
	LDAB UM
	CMPB #3
	BHI VEINTICUATRO
	LDY #$9280
	LDAB CONT_MAYUS
	BEQ VEINTITRES_N
	JSR IMPRESION_MINUS
VEINTITRES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

VEINTICUATRO
	LDAB UM
	CMPB #4
	BHI VEINTICINCO
	LDY #$9290
	LDAB CONT_MAYUS
	BEQ VEINTICUATRO_N
	JSR IMPRESION_MINUS
VEINTICUATRO_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

VEINTICINCO
	LDAB UM
	CMPB #5
	BHI VEINTISEIS
	LDY #$92A0
	LDAB CONT_MAYUS
	BEQ VEINTICINCO_N
	JSR IMPRESION_MINUS
VEINTICINCO_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

VEINTISEIS
	LDAB UM
	CMPB #6
	BHI VEINTISIETE
	LDY #$92B0
	LDAB CONT_MAYUS
	BEQ VEINTISEIS_N
	JSR IMPRESION_MINUS
VEINTISEIS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

VEINTISIETE
	LDAB UM
	CMPB #7
	BHI VEINTIOCHO
	LDY #$92C0
	LDAB CONT_MAYUS
	BEQ VEINTISIETE_N
	JSR IMPRESION_MINUS
VEINTISIETE_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

VEINTIOCHO
	LDAB UM
	CMPB #8
	BHI VEINTINUEVE
	LDY #$92D0
	LDAB CONT_MAYUS
	BEQ VEINTIOCHO_N
	JSR IMPRESION_MINUS
VEINTIOCHO_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

VEINTINUEVE
	LDY #$92E0
	LDAB CONT_MAYUS
	BEQ VEINTINUEVE_N
	JSR IMPRESION_MINUS
VEINTINUEVE_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

TRES_DMILES
	LDAA DM
	CMPA #3
	BNE CUATRO_DMILES
	LDY #$9098
	LDAB CONT_MAYUS
	BEQ TRES_DMILES_N
	JSR IMPRESION_MINUS
TRES_DMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	*JMP UNO_UMILES_OK
	JMP YANTES

CUATRO_DMILES
	LDAA DM
	CMPA #4
	BNE CINCO_DMILES
	LDY #$90A8
	LDAB CONT_MAYUS
	BEQ CUATRO_DMILES_N
	JSR IMPRESION_MINUS
CUATRO_DMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	*JMP UNO_UMILES_OK
	JMP YANTES

CINCO_DMILES
	LDAA DM
	CMPA #5
	BNE SEIS_DMILES
	LDY #$90BC
	LDAB CONT_MAYUS
	BEQ CINCO_DMILES_N
	JSR IMPRESION_MINUS
CINCO_DMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	*JMP UNO_UMILES_OK
	JMP YANTES

SEIS_DMILES
	LDAA DM
	CMPA #6
	BNE SIETE_DMILES
	LDY #$90C8
	LDAB CONT_MAYUS
	BEQ SEIS_DMILES_N
	JSR IMPRESION_MINUS
SEIS_DMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	*JMP UNO_UMILES_OK
	JMP YANTES

SIETE_DMILES
	LDAA DM
	CMPA #7
	BNE OCHO_DMILES
	LDY #$90D8
	LDAB CONT_MAYUS
	BEQ SIETE_DMILES_N
	JSR IMPRESION_MINUS
SIETE_DMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	*JMP UNO_UMILES_OK
	JMP YANTES

OCHO_DMILES
	LDAA DM
	CMPA #8
	BNE NUEVE_DMILES
	LDY #$90E8
	LDAB CONT_MAYUS
	BEQ OCHO_DMILES_N
	JSR IMPRESION_MINUS
OCHO_DMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	*JMP UNO_UMILES_OK
	JMP YANTES

NUEVE_DMILES
	LDY #$90F8
	LDAB CONT_MAYUS
	BEQ NUEVE_DMILES_N
	JSR IMPRESION_MINUS
NUEVE_DMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	*JMP UNO_UMILES_OK
	JMP YANTES
	
YANTES
	LDAA UM
	CMPA #0
	BHI YDESPUES
	JMP UNO_UMILES_OK
YDESPUES
	LDY #$8FC8
	JSR IMPRESION
	JMP UNO_UMILES_OK
*****************
*	UMILES	*
*****************
UNO_UMILES
	LDAA UM
	BEQ THOUSANDRANA
	JMP UNO_UMILES_OK

THOUSANDRANA
	LDAA CONT_THOUSAND
	BEQ THOUSAND_NO
	JMP THOUSAND

THOUSAND_NO
	JMP INTER_CEROS_C3
	*JMP UNO_CENTENAS
	
UNO_UMILES_OK
	LDAA UM
	CMPA #1
	BNE DOS_UMILES
	LDAA DM
	CMPA #0
	BHI MAYBE_UN
	JMP UNO_UMILES_INTER

MAYBE_UN
	LDY #$8F60
	LDAB CONT_MAYUS
	BEQ UNO_UMILES_N2
	JSR IMPRESION_MINUS
UNO_UMILES_N2
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

UNO_UMILES_INTER
	LDY #$9150
	LDAB CONT_MAYUS
	BEQ UNO_UMILES_N
	JSR IMPRESION_MINUS
UNO_UMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP UNO_CENTENAS

DOS_UMILES
	LDAA UM
	CMPA #2
	BNE TRES_UMILES
	LDY #$8F68
	LDAB CONT_MAYUS
	BEQ DOS_UMILES_N
	JSR IMPRESION_MINUS
DOS_UMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

TRES_UMILES
	LDAA UM
	CMPA #3
	BNE CUATRO_UMILES
	LDY #$8F70
	LDAB CONT_MAYUS
	BEQ TRES_UMILES_N
	JSR IMPRESION_MINUS
TRES_UMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

CUATRO_UMILES
	LDAA UM
	CMPA #4
	BNE CINCO_UMILES
	LDY #$8F78
	LDAB CONT_MAYUS
	BEQ CUATRO_UMILES_N
	JSR IMPRESION_MINUS
CUATRO_UMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

CINCO_UMILES
	LDAA UM
	CMPA #5
	BNE SEIS_UMILES
	LDY #$8F80
	LDAB CONT_MAYUS
	BEQ CINCO_UMILES_N
	JSR IMPRESION_MINUS
CINCO_UMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

SEIS_UMILES
	LDAA UM
	CMPA #6
	BNE SIETE_UMILES
	LDY #$8F88
	LDAB CONT_MAYUS
	BEQ SEIS_UMILES_N
	JSR IMPRESION_MINUS
SEIS_UMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

SIETE_UMILES
	LDAA UM
	CMPA #7
	BNE OCHO_UMILES
	LDY #$8F90
	LDAB CONT_MAYUS
	BEQ SIETE_UMILES_N
	JSR IMPRESION_MINUS
SIETE_UMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

OCHO_UMILES
	LDAA UM
	CMPA #8
	BNE NUEVE_UMILES
	LDY #$8F98
	LDAB CONT_MAYUS
	BEQ OCHO_UMILES_N
	JSR IMPRESION_MINUS
OCHO_UMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

NUEVE_UMILES
	LDY #$8FA0
	LDAB CONT_MAYUS
	BEQ NUEVE_UMILES_N
	JSR IMPRESION_MINUS
NUEVE_UMILES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP THOUSAND

THOUSAND
	LDY #$8FD0
	JSR IMPRESION
	JMP INTER_CEROS_C3
	*JMP UNO_CENTENAS

COMA2_ANTES
	LDAA UM 
	CMPA #1
	*BEQ UNO_CENTENAS
	BEQ INTER_CEROS_C3
	LDAA C
	CMPA #0
	BHI COMA2
	LDAA D
	CMPA #0
	BHI COMA2

COMA2
	LDAB CONT_COMA
	LDY #$9080
	JSR IMPRESION

****************************************************
INTER_CEROS_C3
	LDAA C
	CMPA #0
	BEQ INTER_CEROS_D3
	JMP UNO_CENTENAS
INTER_CEROS_D3
	LDAA D
	CMPA #0
	BEQ INTER_CEROS_U3
	JMP UNO_DECENAS
INTER_CEROS_U3
	LDAA UM
	CMPA #0
	BEQ INTER_DOLLARS3
	JMP CERO_UNIDADES
INTER_DOLLARS3
	JMP DOLLARS

UNO_CENTENAS
	CLR CONT_GUION
	CLR CONT_AND
	CLR CONT_COMA
	LDAB CONT_MAYUS
	BEQ UNO_CENTENAS_OK
	INC CONT_COMA
	LDAA C
	CMPA #1
	BEQ CIEN1
	JMP DOS_CENTENAS

CIEN1
	LDAA D
	CMPA #0
	BEQ CIEN2
	JMP UNO_DECENAS

CIEN2
	LDAA U
	CMPA #0
	BEQ CIEN3
	JMP CERO_UNIDADES

CIEN3
	LDY #$9158
	LDAB CONT_MAYUS
	BEQ DOS_CENTENAS_N
	JSR IMPRESION_MINUS
CIEN3_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP DOLLARS
	
UNO_CENTENAS_OK
	LDAA C
	BEQ UNO_DECENASRANA

NO_COMA3
	INC CONT_AND
	CMPA #1
	BNE DOS_CENTENAS
	LDY #$9130
	LDAB CONT_MAYUS
	BEQ UNO_CENTENAS_N
	JSR IMPRESION_MINUS
UNO_CENTENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP UNO_DECENAS

UNO_DECENASRANA
	JMP UNO_DECENAS

DOS_CENTENAS
	LDAA C
	CMPA #2
	BNE TRES_CENTENAS
	LDY #$8F68
	LDAB CONT_MAYUS
	BEQ DOS_CENTENAS_N
	JSR IMPRESION_MINUS
DOS_CENTENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP HUNDRED2

TRES_CENTENAS
	LDAA C
	CMPA #3
	BNE CUATRO_CENTENAS
	LDY #$8F70
	LDAB CONT_MAYUS
	BEQ TRES_CENTENAS_N
	JSR IMPRESION_MINUS
TRES_CENTENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP HUNDRED2

CUATRO_CENTENAS
	LDAA C
	CMPA #4
	BNE CINCO_CENTENAS
	LDY #$8F78
	LDAB CONT_MAYUS
	BEQ CUATRO_CENTENAS_N
	JSR IMPRESION_MINUS
CUATRO_CENTENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP HUNDRED2

CINCO_CENTENAS
	LDAA C
	CMPA #5
	BNE SEIS_CENTENAS
	LDY #$9120
	LDAB CONT_MAYUS
	BEQ CINCO_CENTENAS_N
	JSR IMPRESION_MINUS
CINCO_CENTENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP UNO_DECENAS
	
SEIS_CENTENAS
	LDAA C
	CMPA #6
	BNE SIETE_CENTENAS
	LDY #$8F88
	LDAB CONT_MAYUS
	BEQ SEIS_CENTENAS_N
	JSR IMPRESION_MINUS
SEIS_CENTENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP HUNDRED2

SIETE_CENTENAS
	LDAA C
	CMPA #7
	BNE OCHO_CENTENAS
	LDY #$9140
	LDAB CONT_MAYUS
	BEQ SIETE_CENTENAS_N
	JSR IMPRESION_MINUS
SIETE_CENTENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP HUNDRED2

OCHO_CENTENAS
	LDAA C
	CMPA #8
	BNE NUEVE_CENTENAS
	LDY #$8F98
	LDAB CONT_MAYUS
	BEQ OCHO_CENTENAS_N
	JSR IMPRESION_MINUS
OCHO_CENTENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP HUNDRED2

NUEVE_CENTENAS
	LDY #$911B
	LDAB CONT_MAYUS
	BEQ NUEVE_CENTENAS_N
	JSR IMPRESION_MINUS
NUEVE_CENTENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP HUNDRED2
	
HUNDRED2
	LDY #$8FB8
	JSR IMPRESION
***********************************************
UNO_DECENAS
	LDAA D
	BEQ CERO_UNIDADESRANA

UNO_DECENAS_OK
	CMPA #1
	BNE DOS_DECENASRANA
	LDAB U
	BNE QUINCE2

CERO_UNIDADESRANA
	JMP CERO_UNIDADES

DOS_DECENASRANA
	JMP DOS_DECENAS

DIEZ2
	LDY #$8FF0
	LDAB CONT_MAYUS
	BEQ DIEZ2_N
	JSR IMPRESION_MINUS
DIEZ2_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP DOLLARS

QUINCE2
	LDY #$9030
	LDAB CONT_MAYUS
	BEQ QUINCE2_N
	JSR IMPRESION_MINUS
QUINCE2_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP DOLLARS
**********************************************
DOS_DECENAS
	LDAA D
	CMPA #2
	BNE TRES_DECENAS
	LDY #$9088
	LDAB CONT_MAYUS
	BEQ DOS_DECENAS_N
	JSR IMPRESION_MINUS
DOS_DECENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP CERO_UNIDADES
	
TRES_DECENAS
	LDAA D
	CMPA #3
	BNE CUATRO_DECENAS
	LDY #$9098
	LDAB CONT_MAYUS
	BEQ TRES_DECENAS_N
	JSR IMPRESION_MINUS
TRES_DECENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP YANTES2
	*JMP CERO_UNIDADES

CUATRO_DECENAS
	LDAA D
	CMPA #4
	BNE CINCO_DECENAS
	LDY #$90A8
	LDAB CONT_MAYUS
	BEQ CUATRO_DECENAS_N
	JSR IMPRESION_MINUS
CUATRO_DECENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP YANTES2
	*JMP CERO_UNIDADES

CINCO_DECENAS
	LDAA D
	CMPA #5
	BNE SEIS_DECENAS
	LDY #$90BC
	LDAB CONT_MAYUS
	BEQ CINCO_DECENAS_N
	JSR IMPRESION_MINUS
CINCO_DECENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP YANTES2
	*JMP CERO_UNIDADES

SEIS_DECENAS
	LDAA D
	CMPA #6
	BNE SIETE_DECENAS
	LDY #$90C8
	LDAB CONT_MAYUS
	BEQ SEIS_DECENAS_N
	JSR IMPRESION_MINUS
SEIS_DECENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP YANTES2
	*JMP CERO_UNIDADES

SIETE_DECENAS
	LDAA D
	CMPA #7
	BNE OCHO_DECENAS
	LDY #$90D8
	LDAB CONT_MAYUS
	BEQ SIETE_DECENAS_N
	JSR IMPRESION_MINUS
SIETE_DECENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP YANTES2
	*JMP CERO_UNIDADES

OCHO_DECENAS
	LDAA D
	CMPA #8
	BNE NUEVE_DECENAS
	LDY #$90E8
	LDAB CONT_MAYUS
	BEQ OCHO_DECENAS_N
	JSR IMPRESION_MINUS
OCHO_DECENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP YANTES2
	*JMP CERO_UNIDADES

NUEVE_DECENAS
	LDY #$90F8
	LDAB CONT_MAYUS
	BEQ NUEVE_DECENAS_N
	JSR IMPRESION_MINUS
NUEVE_DECENAS_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP YANTES2
	*JMP CERO_UNIDADES

YANTES2
	LDAA U
	CMPA #0
	BHI YDESPUES2
	JMP CERO_UNIDADES
YDESPUES2
	LDY #$8FC8
	JSR IMPRESION
	JMP CERO_UNIDADES
*********************************************
CERO_UNIDADES
	LDAA U
	CMPA #0
	BNE UNO_UNIDADES
	JMP ZERO

COMA5
	LDAB CONT_COMA
	LDY #$9080
	JSR IMPRESION

UNO_UNIDADES
	LDAA U
	CMPA #1
	BHI DOS_UNIDADES
	LDY #$8F60
	LDAB CONT_MAYUS
	BEQ UNO_UNIDADES_N
	JSR IMPRESION_MINUS
UNO_UNIDADES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP DOLLARS

DOS_UNIDADES
	LDAA U
	CMPA #2
	BHI TRES_UNIDADES
	LDY #$8F68
	LDAB CONT_MAYUS
	BEQ DOS_UNIDADES_N
	JSR IMPRESION_MINUS
DOS_UNIDADES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP DOLLARS

TRES_UNIDADES
	LDAA U
	CMPA #3
	BHI CUATRO_UNIDADES
	LDY #$8F70
	LDAB CONT_MAYUS
	BEQ TRES_UNIDADES_N
	JSR IMPRESION_MINUS
TRES_UNIDADES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP DOLLARS

CUATRO_UNIDADES
	LDAA U
	CMPA #4
	BHI CINCO_UNIDADES
	LDY #$8F78
	LDAB CONT_MAYUS
	BEQ CUATRO_UNIDADES_N
	JSR IMPRESION_MINUS
CUATRO_UNIDADES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP DOLLARS

CINCO_UNIDADES
	LDAA U
	CMPA #5
	BHI SEIS_UNIDADES
	LDY #$8F80
	LDAB CONT_MAYUS
	BEQ CINCO_UNIDADES_N
	JSR IMPRESION_MINUS
CINCO_UNIDADES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP DOLLARS

SEIS_UNIDADES
	LDAA U
	CMPA #6
	BHI SIETE_UNIDADES
	LDY #$8F88
	LDAB CONT_MAYUS
	BEQ SEIS_UNIDADES_N
	JSR IMPRESION_MINUS
SEIS_UNIDADES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP DOLLARS

SIETE_UNIDADES
	LDAA U
	CMPA #7
	BHI OCHO_UNIDADES
	LDY #$8F90
	LDAB CONT_MAYUS
	BEQ SIETE_UNIDADES_N
	JSR IMPRESION_MINUS
SIETE_UNIDADES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP DOLLARS

OCHO_UNIDADES
	LDAA U
	CMPA #8
	BHI NUEVE_UNIDADES
	LDY #$8F98
	LDAB CONT_MAYUS
	BEQ OCHO_UNIDADES_N
	JSR IMPRESION_MINUS
OCHO_UNIDADES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP DOLLARS

NUEVE_UNIDADES
	LDY #$8FA0
	LDAB CONT_MAYUS
	BEQ NUEVE_UNIDADES_N
	JSR IMPRESION_MINUS
NUEVE_UNIDADES_N
	INC CONT_MAYUS
	JSR IMPRESION
	JMP DOLLARS

ZERO
	LDY #$9210
	LDAB #IVADCENT
	CMPA #0
	BHI CENTAVOS
	LDAB CONT_MAYUS
	BNE DOLLARS
	JSR IMPRESION
	JMP DOLLARS

DOLLARS
	LDAA IVADCENT
	CMPA #0
	BNE CENTAVOS
	LDY #$8FE0
	JSR IMPRESION
	JMP OK

CENTAVOS
	LDY #$94F0
	JSR IMPRESION
	JMP OK

*********************************************
IMPRESION_MINUS
	LDAB $00,Y
	INY
	ADDB #$20
	STAB $00,X
	INX
	RTS

IMPRESION
	LDAB $00,Y
	INY
	CMPB #'|
	BNE IMPRESION_CONT
	RTS

IMPRESION_CONT
	STAB $00,X
	INX
	JMP IMPRESION

OK
	CLR O
OK_CICLO
	LDAA #'?
	STAA PRO

CICLO_OK
	LDAA PRO
	CMPA #'?
	BEQ CICLO_OK
CHECA_O
	LDAB O
	BNE CHECAR_K
	LDAA PRO
OTRA_O	
	CMPA #'O
	BNE OK
	STAA O
	JMP OK_CICLO
	
CHECAR_K
	LDAA PRO
	CMPA #'K
	BNE OTRA_O
	LDAA #$FF
	LDX #$0080
VAMO_A_LIMPIARLO
	CPX #$0200
	BEQ LIMPIAO
	STAA $00,X
	INX
	JMP VAMO_A_LIMPIARLO
LIMPIAO
	JMP INICIO

*********************************
*	CADENAS DE CARACTERES	*
*********************************
CADENAS_CANT
	ORG $8F00
	FCC 'A |U $|'
	FCC 'B |U $|'
	FCC 'C |U $|'
	FCC 'D |U $|'
	FCC 'E |U $|'
	FCC 'F |U $|'
	FCC 'G |U $|'
	FCC 'H |U $|'
	FCC 'I |U $|'
	FCC 'J |U $|'

CADENAS_TOTAL
	ORG $8F50
	FCC 'Total $|'
	FCC ' (|'
	
	ORG $8F60
	FCC 'Un|'
	ORG $8F68
	FCC 'Dos|'
	ORG $8F70
	FCC 'Tres|'
	ORG $8F78
	FCC 'Cuatro|'
	ORG $8F80
	FCC 'Cinco|'
	ORG $8F88
	FCC 'Seis|'
	ORG $8F90
	FCC 'Siete|'
	ORG $8F98
	FCC 'Ocho|'
	ORG $8FA0
	FCC 'Nueve|'
	ORG $8FA7	
	FCC ' millones, |'
	ORG $8FB8
	FCC 'cientos |'
	ORG $8FC8
	FCC ' y |'
	ORG $8FD0
	FCC ' mil, |'
	ORG $8FE0
	FCC ' dolares.)|'
	ORG $8FF0
	FCC 'Diez|'
	ORG $8FF8
	FCC 'Once|'
	ORG $9000
	FCC 'Doce|'
	ORG $9010
	FCC 'Trece|'
	ORG $9020
	FCC 'Catorce|'
	ORG $9030
	FCC 'Quince|'
	ORG $9040
	FCC 'DiesisEis|'
	ORG $9050
	FCC 'Diesisiete|'
	ORG $9060
	FCC 'Diesiocho|'
	ORG $9070
	FCC 'Diesinueve|'
	ORG $9080
	FCC ', |'
	ORG $9088
	FCC 'Veinte|'
	ORG $9098
	FCC 'Treinta|'
	ORG $90A8
	FCC 'Cuarenta|'
	ORG $90BC 
	FCC 'Cincuenta|'
	ORG $90C8
	FCC 'Sesenta|'
	ORG $90D8
	FCC 'Setenta|'
	ORG $90E8
	FCC 'Ochenta|'
	ORG $90F8
	FCC 'Noventa|'
	ORG $9108
	FCC '-|'
	ORG $9110
	FCC ' millon, |'
	ORG $911B
	FCC 'Nove|'
	ORG $9120
	FCC 'Quinientos|'
	ORG $9130 		
	FCC 'Ciento |'
	ORG $9140
	FCC 'Sete|'
	ORG $9150
	FCC 'Mil, |'
	ORG $9158
	FCC 'Cien|'
	ORG $9160 
	FCC '.|'
	ORG $9170 
	FCC 'IVA: $|'
	ORG $9180
	FCC 'Total final: $|'
	
	ORG $91A0
	FCC 'CARACTER NO VALIDO.|'
	ORG $91B8
	FCC 'RESTA DE PRODUCTO INEXISTENTE.|'
	ORG $91D8
	FCC 'SUMA EXCEDIO LOS 10 MILLONES DE DOLARES.|'
	ORG $9210
	FCC 'Zero|'
	
	ORG $9260
	FCC 'Veintiun|'
	ORG $9270
	FCC 'VeintidOs|'
	ORG $9280
	FCC 'VeintitrEs|'
	ORG $9290
	FCC 'Veinticuatro|'
	ORG $92A0
	FCC 'Veinticinco|'
	ORG $92B0
	FCC 'VeintisEis|'
	ORG $92C0
	FCC 'Veintisiete|'
	ORG $92D0
	FCC 'Veintiocho|'
	ORG $92E0
	FCC 'Veintinueve|'
	ORG $93F0
	FCC '(|'
	ORG $94F0
	FCC ' dolares con cinco centavos.)|'
	ORG $9530
	FCC 'Ahorro $|'

*****************************************
*	CONFIGURACION PUERTO SERIAL	*
*****************************************	
SERIAL
       LDD   #$302C  * CONFIGURA PUERTO SERIAL
       STAA  BAUD    * BAUD  9600  para cristal de 8MHz
       STAB  SCCR2   * HABILITA  RX Y TX PERO INTERRUPCN SOLO RX
       LDAA  #$00
       STAA  SCCR1   * 8 BITS

       LDAA  #$FE    * CONFIG PUERTO D COMO SALIDAS (EXCEPTO PD0)
       STAA  DDRD    * SEA  ENABLE DEL DISPLAY  PD4  Y RS PD3 
      
       LDAA  #$04
       STAA  HPRIO

       LDAA  #$00
       TAP

       RTS

*********************************
* 	INTERRUPCION SERIAL	*
*********************************
       ORG  $F100
 
       LDAA SCSR
       LDAA SCDR
       STAA PRO
       RTI

***********************************
* VECTOR INTERRUPCION SERIAL
***********************************
       ORG   $FFD6
       FCB   $F1,$00       

***********************************
*RESET
***********************************
       ORG    $FFFE
RESET  FCB    $80,$00
***********************************
       END   $7000